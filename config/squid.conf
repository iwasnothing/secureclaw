# Security: Hide hostname info
visible_hostname agent-firewall

# 1. Define Whitelist
acl allowed_domains dstdomain .telegram.org
acl allowed_domains dstdomain api.telegram.org

# 2. Define Ports
acl SSL_ports port 443
acl Safe_ports port 80
acl Safe_ports port 443
acl CONNECT method CONNECT

# 3. Apply Rules
http_access deny !Safe_ports
http_access deny CONNECT !SSL_ports

# Only allow whitelisted domains
http_access allow allowed_domains

# Block everything else
http_access deny all

# 4. Port
http_port 3128
coredump_dir /var/spool/squid
